# スコア保存リポジトリ層実装

## 目的 / 背景

- `docs/plan_0907.md` 2.1: scores リポジトリ。
- ハンドラとDBアクセスの分離でテスト容易性向上。

## 完了条件

- パッケージ: `backend/internal/repository/scores_repo.go` 作成。
- インターフェース: `ScoresRepository` ( `Create(ctx, record *Score) error`, `FindLeaderboard(ctx, period, limit) ([]LeaderboardRow, error)`, `FindUserScores(ctx, userID, filter) ([]Score, error)` )。
- テスト: モック / ローカルDBで Insert & Select 正常系 1件以上。
- トランザクション不要（単純INSERT）。

## スコープ

- 含む: INSERT, leaderboard簡易集計 (期間: day/week/all)。
- 含まない: 高度なランキングロジック（スコア平均 / ベスト更新条件）。

## 作業手順

- [ ] データ構造体定義 (Score, LeaderboardRow)
- [ ] INSERT 実装
- [ ] leaderboard クエリ (期間条件 CASE)
- [ ] user scores クエリ
- [ ] テスト追加

## 依存関係 / リスク

- 依存: scores拡張マイグレーション
- リスク: 集計パフォーマンス → MVP段階でシンプルSQL

## 見積り / 担当 / 期日

- 見積り: 0.5人日
- 担当: 未定
- 期日: Sprint1 後半 (2025-09-14)

## 参考リンク

- `../plan_0907.md`
